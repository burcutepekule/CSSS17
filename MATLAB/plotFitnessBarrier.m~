clear all;close all;clc;
load('SIM_MUT_0')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_0(i,k) = entrpy;
    end
end
load('SIM_MUT_01')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_01(i,k) = entrpy;
    end
end
load('SIM_MUT_1')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_1(i,k) = entrpy;
    end
end
load('SIM_MUT_10')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_10(i,k) = entrpy;
    end
end
load('SIM_MUT_20')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_20(i,k) = entrpy;
    end
end
load('SIM_MUT_50')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_50(i,k) = entrpy;
    end
end
load('SIM_MUT_100')
for i=1:length(y0LastVary)
    for k=1:length(mVec)
        vec = X(i,k,:);
        vecMat = reshape(vec(:),PN,N);
        entrpy = 0;
        for j=1:PN
            vecTemp = vecMat(j,:);
            vecNorm = vecTemp./sum(vecTemp);
            entrpy = entrpy-1*sum(vecNorm.*log(vecNorm));
        end
        ent_100(i,k) = entrpy;
    end
end
%%
set(0,'DefaultAxesFontSize',14)
cutOffm = length(mVec);
[Xx,Yy] = meshgrid(mVec(1:cutOffm),y0LastVary);
ent_0   = ent_0(:,1:cutOffm);
ent_01  = ent_01(:,1:cutOffm);
ent_1   = ent_1(:,1:cutOffm);
ent_10  = ent_10(:,1:cutOffm);
ent_20  = ent_20(:,1:cutOffm);
ent_50  = ent_50(:,1:cutOffm);
ent_100 = ent_100(:,1:cutOffm);

figure

hold on;
ylabel('$x_{3}^{3}[0]$','interpreter','latex')
xlabel('$m$','interpreter','latex')
zlabel('entropy')
colorbar

% s0=surf(Xx,Yy,ent_0);
% s0.EdgeColor = 'none';
% pause
% s01=surf(Xx,Yy,ent_01);
% s01.EdgeColor = 'none';
% pause
% s1=surf(Xx,Yy,ent_1);
% s1.EdgeColor = 'none';
% pause
s10=surf(Xx,Yy,ent_10);
s10.EdgeColor = 'none';
pause
s20=surf(Xx,Yy,ent_20);
s20.EdgeColor = 'none';
pause
s50=surf(Xx,Yy,ent_50);
s50.EdgeColor = 'none';
pause
s100=surf(Xx,Yy,ent_100);
s100.EdgeColor = 'none';
pause
% leg=legend('$q=0$','$q=0.0001$','$q=0.001$','$q=0.01$','$q=0.1$');
% set(leg,'interpreter','latex')
%%

